# Création de shapefiles pour le département 92
file://departement-92 <- file://departements-pbf/departement-92.osm.pbf
    mkdir departement-92

file://departement-92/places.shp, file://departement-92/places.shx, file://departement-92/places.prj, file://departement-92/places.dbf, file://departement-92/places.cpg <- file://departements-pbf/departement-92.osm.pbf, file://departement-92, file://osm_extract/osm_config.ini
     ogr2ogr -f "ESRI Shapefile" departement-92/places.shp --config OSM_CONFIG_FILE osm_extract/osm_config.ini -sql "select osm_id, name, place AS "type", population from points where place is not null" -lco ENCODING=UTF-8 departements-pbf/departement-92.osm.pbf

file://departement-92/roads.shp <- file://departements-pbf/departement-92.osm.pbf, file://departement-92, file://osm_extract/osm_config.ini
    ogr2ogr -f "ESRI Shapefile" departement-92/roads.shp --config OSM_CONFIG_FILE osm_extract/osm_config.ini -sql "select osm_id, name, highway AS "type", CAST(oneway AS integer) + 1 AS "oneway", CAST(bridge AS integer) + 1 AS bridge, CAST(tunnel AS integer) + 1 AS tunnel, CAST(maxspeed AS integer) + 1 AS maxspeed from lines where highway is not null" -lco ENCODING=UTF-8 departements-pbf/departement-92.osm.pbf
    
file://departement-92/buildings.shp, file://departement-92/buildings.shx, file://departement-92/buildings.prj, file://departement-92/buildings.dbf, file://departement-92/buildings.cpg <- file://departements-pbf/departement-92.osm.pbf, file://departement-92, file://osm_extract/osm_config.ini
    ogr2ogr -f "ESRI Shapefile" departement-92/buildings.shp --config OSM_CONFIG_FILE osm_extract/osm_config.ini -sql "select osm_id, name, building AS "type" from multipolygons where building is not null" -lco ENCODING=UTF-8 departements-pbf/departement-92.osm.pbf

file://departement-92/railways.shp, file://departement-92/railways.shx, file://departement-92/railways.prj, file://departement-92/railways.dbf, file://departement-92/railways.cpg <- file://departements-pbf/departement-92.osm.pbf, file://departement-92, file://osm_extract/osm_config.ini
    ogr2ogr -f "ESRI Shapefile" departement-92/railways.shp --config OSM_CONFIG_FILE osm_extract/osm_config.ini -sql "select osm_id, name, railway AS "type", width from lines where railway is not null" -lco ENCODING=UTF-8 departements-pbf/departement-92.osm.pbf

file://departement-92/waterways.shp, file://departement-92/waterways.shx, file://departement-92/waterways.prj, file://departement-92/waterways.dbf, file://departement-92/waterways.cpg <- file://departements-pbf/departement-92.osm.pbf, file://departement-92, file://osm_extract/osm_config.ini
    ogr2ogr -f "ESRI Shapefile" departement-92/waterways.shp --config OSM_CONFIG_FILE osm_extract/osm_config.ini -sql "select osm_id, name, waterway AS "type", width from lines where waterway is not null" -lco ENCODING=UTF-8 departements-pbf/departement-92.osm.pbf

file://departement-92/points.shp, file://departement-92/points.shx, file://departement-92/points.prj, file://departement-92/points.dbf, file://departement-92/points.cpg <- file://departements-pbf/departement-92.osm.pbf, file://departement-92, file://osm_extract/osm_config.ini
    ogr2ogr -f "ESRI Shapefile" departement-92/points.shp --config OSM_CONFIG_FILE osm_extract/osm_config.ini -dialect SQLITE -sql "select osm_id, GEOMETRY, name, coalesce(REPLACE(highway,'yes','highway'), REPLACE(man_made,'yes','man_made'), REPLACE(amenity,'yes','amenity'), REPLACE(shop,'yes','shop'), REPLACE(tourism,'yes','tourism'), REPLACE(railway,'yes','railway'), REPLACE(historic,'yes','historic'), REPLACE(office,'yes','office'), REPLACE(craft,'yes','craft')) AS type FROM points WHERE highway is not null OR man_made is not null OR amenity is not null OR shop is not null OR tourism is not null OR railway is not null OR historic is not null OR office is not null OR craft is not null" -lco ENCODING=UTF-8 departements-pbf/departement-92.osm.pbf

file://departement-92/natural.shp, file://departement-92/natural.shx, file://departement-92/natural.prj, file://departement-92/natural.dbf, file://departement-92/natural.cpg <- file://departements-pbf/departement-92.osm.pbf, file://departement-92, file://osm_extract/osm_config.ini
    ogr2ogr -f "ESRI Shapefile" departement-92/natural.shp --config OSM_CONFIG_FILE osm_extract/osm_config.ini -dialect SQLITE -sql "select osm_id, GEOMETRY, name, coalesce(waterway,leisure,landuse,REPLACE(natural,'wood','forest')) AS "type" from multipolygons where waterway is not null or leisure='park' or landuse='forest' or landuse='park' or natural='wood' or natural='water'" -lco ENCODING=UTF-8 departements-pbf/departement-92.osm.pbf

file://departement-92/landuse.shp, file://departement-92/landuse.shx, file://departement-92/landuse.prj, file://departement-92/landuse.dbf, file://departement-92/landuse.cpg <- file://departements-pbf/departement-92.osm.pbf, file://departement-92, file://osm_extract/osm_config.ini
    ogr2ogr -f "ESRI Shapefile" departement-92/landuse.shp --config OSM_CONFIG_FILE osm_extract/osm_config.ini -sql "select osm_id, name, landuse AS "type" from multipolygons where landuse is not null" -lco ENCODING=UTF-8 departements-pbf/departement-92.osm.pbf

file://departement-92/admin-departement.shp, file://departement-92/admin-departement.shx, file://departement-92/admin-departement.prj, file://departement-92/admin-departement.dbf <- file://departement-92, file://departements
    ogr2ogr -f "ESRI Shapefile" departement-92/admin-departement.shp -where "code_insee='92'" departements/departements.shp

file://departement-92/departement.qgs <- file://departement.qgs
    cp departement.qgs departement-92/departement.qgs

file://zips/departement-92.zip <- file://zips, file://departement-92/departement.qgs, file://departement-92/admin-departement.shp, file://departement-92/places.shp, file://departement-92/roads.shp, file://departement-92/buildings.shp, file://departement-92/railways.shp, file://departement-92/waterways.shp, file://departement-92/points.shp, file://departement-92/natural.shp, file://departement-92/landuse.shp
    zip -r zips/departement-92.zip departement-92